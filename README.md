# Предсказание стоимости авто

([Тетрадка с проектом](https://github.com/Vanarty/linear_regression_with_streamlit/blob/main/notebook/work_notebook.ipynb))
([Streamlit приложение](https://prediction-auto-price-with-linear-regression.streamlit.app))

* Автор проекта - *Иванов Артём Юрьевич*
* vanarty@yandex.ru

В данном приложении можно быстро узнать рыночную стоимость автомобиля. 

## Исходные данные:
В распоряжении исторические данные: технические характеристики и цены автомобилей. Нужно построить линейную модель для определения рыночной стоимости. 

## Было выполнено:
1. загружены тренировочный (cars_train.csv, 6999 записей) и тестовый (cars_test.csv, 1000 записей) датасеты
2. проведена начальная предобработка (заполнены пропуски медианой, обработаны явные дубликаты). Процент пропусков в тренировочных данных: 2.8-2.9%, в тестовых: 1.9%;
3. были дополнительно предобработаны категориальные признаки `name` (**Frequency Encoding, One-hot для топ-N, Target Encoding, HASHING TRICK (Хеширование)**) и `seats` (**one-hot-encoding**);
4. проведен анализ данных (EDA-исследование). Использована библиотека ydata-profiling для генерации комплексного отчёта по данным;
5. **проведено отдельное исследование пропущенных значений**, с последующей их обработкой;
6. все числовые признаки были стандартизированы перед обучением моделей;
7. с предварительным подбором гиперпараметров обучены **5 моделей** на основе линейныйх моделей: **Linear Regression**, **'Lasso', 'ElasticNet', 'Ridge', 'LightGBM'**. 
8. выбрана лучшая модель по результатам метрикам **R-квадрат** и **MSE**;
9. лучшая модель оценена на тестовой (отложенной) выборке;
10. определены наиболее важные признаки для предсказания стоимости авто;
11. для повышения качества предсказаний целевой признак `selling_price` был логарифмирован;
12. даны рекомендации для возможного улучшения работы.

## Выводы:
Особенности выборки: данные содержат автомобили разных ценовых категорий — от бюджетных до премиум-класса, что может потребовать особого подхода к масштабированию и обработке выбросов.

Логарифмическое преобразование целевой переменной, предобработка нескольких категориальных признаков и работа с числовыми признаками позволила повысить качество линейной модели.

Лучшей моделью по условиям задания можно считать **`Ridge`** с предобработкой категориальных признаков `seats` и `name`, подбором гиперпараметра **alpha** с кросс-валидацией на 10 фолдах. Она имеет хороший показатель на тестовых данных  метрик **R-квадрат** (**0.8544**) и **MSE** (**110641959637.77**). Все остальные модели в совокупности показали себя хуже.

Так же была посчитана бизнес-метрика по следующим условиям от бизнеса: среди всех предсказанных цен на авто нужно посчитать долю прогнозов, отличающихся от реальных цен на эти авто не более чем на 10% (в одну или другую сторону). По бизнес метрике **`Ridge`** - модель так же оказалась лучшей и достигла показателя - **0.304**.

Признаки `'год регистрации'`, `'наименование авто'`, `'мощность'` имеют самое высокое значение для предсказания стоимости авто.

По итогам EDA-анлиза и обучения линейной модели было подготовлено Streamlit-приложение, где можно получить предсказание стоимости авто по его параметрам, а так же посмотреть дополнительные графики с EDA и веса линейной модели.

## Что не сделано и что можно улучшить:
1. Поработать с другими категориальными признаками, не вошедшими в обучение моделей;
2. Фич-инжиниринг, поиск интересных комбинаций фичей часто могут дать хороший результат;
3. Попробовать полиномиальные комбинации признаков;
4. Для сравнения моделей возможно использовать adjusted-R2 или RMSE;
5. Так как на этапе EDA анализа было обнаружено, что целевой признак в трейн выборке имеет большие значения, чем в тест выборке имеет смысл обучить квантильную модель с использованием медианы.
